<!DOCTYPE html>
<html>
<head>
    <meta charset=utf-8 />
    <title>Markercluster with Mapbox marker data</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.4/mapbox.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.4/mapbox.css' rel='stylesheet' />
    <style>
      body { margin:0; padding:0; }
      #map { position: relative; width:100%; height: 400px; }
      #hawaii-map { position: relative; width:200px; height: 400px; }
      #greece-map { position: relative; width: 200px; height: 400px;}
      #china-map { position: relative; width: 200px; height: 400px;}
      #korea-map { position: relative; width: 200px; height: 400px;}
    </style>
</head>
<body>
    <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css' rel='stylesheet' />
    <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css' rel='stylesheet' />

    <div id='map'></div>
    <div id='hawaii-map'></div>
    <div id='greece-map'></div>
    <div id='china-map'></div>
    <div id='korea-map'></div>
    <script>
    // Here we don't use the second argument to map, since that would automatically
    // load in non-clustered markers from the layer. Instead we add just the
    // backing tileLayer, and then use the featureLayer only for its data.
    var map = L.mapbox.map('map')
        .setView([39.50, -98.35], 4)
        .addLayer(L.mapbox.tileLayer('medillcherubs.j39famik'));
    
    // Since featureLayer is an asynchronous method, we use the `.on('ready'`
    // call to only use its marker data once we know it is actually loaded.
    L.mapbox.featureLayer('medillcherubs.j39famik').on('ready', function(e) {
        // The clusterGroup gets each marker in the group added to it
        // once loaded, and then is added to the map
        var clusterGroup = new L.MarkerClusterGroup({maxClusterRadius:20});
        e.target.eachLayer(function(layer) {
            clusterGroup.addLayer(layer);
        });
        map.addLayer(clusterGroup);
    });

    var hawaii = L.mapbox.map('hawaii-map', 'medillcherubs.j39famik', {})
        .setView([40.73, -74.011], 4)
     var greece = L.mapbox.map('greece-map', 'medillcherubs.j39famik', {})
        .setView([40.73, -74.011], 4)
     var china = L.mapbox.map('china-map', 'medillcherubs.j39famik', {})
        .setView([40.73, -74.011], 4)
    var korea = L.mapbox.map('korea-map', 'medillcherubs.j39famik', {})
        .setView([40.73, -74.011], 4)
    </script>
</body>
</html>
